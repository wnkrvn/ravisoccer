<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Last War estilo Minecraft</title>
  <style>
    html, body {
      margin:0; padding:0; overflow:hidden;
      width:100%; height:100%; background:#000;
    }
    canvas { display:block; background:#87ceeb; }
    #controls {
      position: fixed; bottom:10px; width:100%;
      display:flex; justify-content:center; gap:20px;
    }
    button {
      width:80px; height:80px; border-radius:50%;
      border:none; background:#333; color:#fff;
      font-size:30px; opacity:0.7;
    }
  </style>
</head>
<body>
  <canvas id="gameCanvas"></canvas>
  <div id="controls">
    <button id="left">⬅️</button>
    <button id="right">➡️</button>
  </div>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    function resize(){
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    resize();
    window.onresize = resize;

    // Imagens
    const playerImg = new Image();
    playerImg.src = "player.png"; // personagem
    const zombieImg = new Image();
    zombieImg.src = "zombie.png"; // zumbi

    let players = [{x:canvas.width/2, y:canvas.height-100, w:40, h:40}];
    let zombies = [];
    let items = [];
    let frame = 0;
    let score = 0;
    let moveDir = 0;

    function spawnHorde(){
      for(let i=0; i<20; i++){
        zombies.push({
          x: Math.random()* (canvas.width-40),
          y: -Math.random()*600,
          w:40, h:40
        });
      }
    }

    function spawnItem(){
      let type = Math.random() < 0.5 ? "x5" : "-6";
      items.push({
        x: Math.random()*(canvas.width-80)+40,
        y: -50,
        w:60, h:60,
        type: type
      });
    }

    function update(){
      frame++;

      // spawns
      if(frame % 300 === 0) spawnHorde();
      if(frame % 400 === 0) spawnItem();

      // mover jogadores
      players.forEach(p => {
        p.x += moveDir * 5;
        if(p.x < 0) p.x = 0;
        if(p.x + p.w > canvas.width) p.x = canvas.width-p.w;
      });

      // mover zumbis
      zombies.forEach((z,i)=>{
        z.y += 3;
        // colisão com players
        players.forEach((p,pi)=>{
          if(p.x < z.x+z.w && p.x+p.w > z.x &&
             p.y < z.y+z.h && p.y+p.h > z.y){
               alert("Game Over! Score: "+score);
               document.location.reload();
          }
        });
      });

      // mover itens
      items.forEach((it,ii)=>{
        it.y += 3;
        players.forEach((p,pi)=>{
          if(p.x < it.x+it.w && p.x+p.w > it.x &&
             p.y < it.y+it.h && p.y+p.h > it.y){
              if(it.type === "x5"){
                // multiplica
                let newPlayers = [];
                players.forEach(pl=>{
                  for(let j=0;j<5;j++){
                    newPlayers.push({...pl, x:pl.x+j*pl.w});
                  }
                });
                players = newPlayers;
              } else {
                // remove 6
                players.splice(0,6);
                if(players.length <= 0){
                  alert("Todos morreram! Score: "+score);
                  document.location.reload();
                }
              }
              items.splice(ii,1);
          }
        });
      });

      score++;
    }

    function draw(){
      ctx.clearRect(0,0,canvas.width,canvas.height);

      // desenha players
      players.forEach(p=>{
        ctx.drawImage(playerImg, p.x, p.y, p.w, p.h);
      });

      // desenha zumbis
      zombies.forEach(z=>{
        ctx.drawImage(zombieImg, z.x, z.y, z.w, z.h);
      });

      // desenha itens
      items.forEach(it=>{
        ctx.fillStyle = it.type === "x5" ? "green" : "red";
        ctx.fillRect(it.x, it.y, it.w, it.h);
        ctx.fillStyle="white";
        ctx.font="20px Arial";
        ctx.fillText(it.type, it.x+10, it.y+35);
      });

      // score
      ctx.fillStyle="white";
      ctx.font="20px Arial";
      ctx.fillText("Score: "+score, 10,30);
      ctx.fillText("Players: "+players.length, 10,60);
    }

    function loop(){
      update();
      draw();
      requestAnimationFrame(loop);
    }
    loop();

    // Controles
    document.getElementById("left").onmousedown = ()=> moveDir=-1;
    document.getElementById("right").onmousedown = ()=> moveDir=1;
    document.getElementById("left").onmouseup = document.getElementById("right").onmouseup = ()=> moveDir=0;

    // teclado
    document.addEventListener("keydown",e=>{
      if(e.key==="ArrowLeft") moveDir=-1;
      if(e.key==="ArrowRight") moveDir=1;
    });
    document.addEventListener("keyup",e=>{
      if(e.key==="ArrowLeft"||e.key==="ArrowRight") moveDir=0;
    });
  </script>
</body>
</html>
